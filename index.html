<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>A Private Letter â€” Elfrida</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:italic,wght@300;400;600&family=Inter:wght@100;200;400&family=Tenor+Sans&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon-blue: #00d2ff; --green: #52b788; }
        * { -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; box-sizing: border-box; }
        body { background: #000; color: #fafafa; font-family: 'Inter', sans-serif; margin: 0; overflow-x: hidden; transition: filter 0.4s ease; }

        /* SILENT PROTECTION */
        body.protected { filter: blur(80px) brightness(0); pointer-events: none; }
        @media print { body { display: none; } }

        /* --- LOGIN SCREEN --- */
        #login-screen {
            position: fixed; inset: 0; z-index: 9999; display: flex; align-items: center; justify-content: center;
            background: linear-gradient(135deg, #000000, #1e1b4b, #4c1d95, #831843, #000000);
            background-size: 400% 400%;
            animation: meshFlow 12s ease-in-out infinite;
            transition: 1.5s cubic-bezier(0.8, 0, 0.2, 1);
        }
        #login-screen::before {
            content: ''; position: absolute; inset: 0;
            backdrop-filter: blur(15px);
            -webkit-mask-image: radial-gradient(circle, transparent 20%, black 80%);
            mask-image: radial-gradient(circle, transparent 20%, black 80%);
            pointer-events: none;
        }
        .login-box {
            position: relative; width: 320px; padding: 50px 40px; 
            background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 4px; 
            text-align: center; z-index: 10;
            box-shadow: 0 0 40px rgba(0,0,0,0.5);
        }
        input {
            width: 100%; background: transparent; border: none; border-bottom: 0.5px solid rgba(255, 255, 255, 0.3);
            padding: 12px 2px; color: white; font-size: 9px; letter-spacing: 5px; margin-bottom: 25px; 
            outline: none; text-align: center; text-transform: uppercase; transition: 0.5s;
        }
        input:focus { border-bottom-color: white; letter-spacing: 7px; }
        .login-btn {
            width: 55px; height: 55px; margin: 15px auto 0; background: white; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            cursor: pointer; transition: 0.5s; box-shadow: 0 0 20px rgba(255,255,255,0.2);
        }
        .login-btn svg { fill: black; width: 22px; height: 22px; }
        .login-btn:hover { transform: scale(1.1); box-shadow: 0 0 30px rgba(255,255,255,0.4); }

        /* --- MAIN CONTENT BG --- */
        .mesh-gradient-bg {
            position: fixed; inset: 0; z-index: -5;
            background: linear-gradient(125deg, #0f172a 0%, #3b0764 25%, #701a75 50%, #db2777 75%, #1e1b4b 100%);
            background-size: 400% 400%;
            animation: meshFlow 15s ease-in-out infinite;
        }
        @keyframes meshFlow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        #main-content { opacity: 0; pointer-events: none; transition: 2s ease; height: 100vh; overflow-y: auto; scroll-behavior: smooth; }
        body.unlocked #login-screen { transform: scale(1.2); opacity: 0; pointer-events: none; }
        body.unlocked #main-content { opacity: 1; pointer-events: auto; }

        .rain { position: fixed; background: rgba(255,255,255,0.2); width: 1px; height: 50px; z-index: -2; pointer-events: none; animation: fall linear infinite; }
        @keyframes fall { to { transform: translateY(110vh); } }

        /* --- WEATHER WIDGET --- */
        .weather-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: left;
        }
        .weather-scroll {
            display: flex; overflow-x: auto; gap: 15px; padding-bottom: 10px;
            scrollbar-width: none;
        }
        .weather-scroll::-webkit-scrollbar { display: none; }
        .hour-item { text-align: center; min-width: 45px; }

        /* --- INTERACTION SYSTEM (PULL STRING) --- */
        .pull-container { position: relative; margin: 40px 0; min-height: 100px; display: flex; flex-direction: column; align-items: flex-end; }
        .string { 
            width: 2px; height: 80px; background: linear-gradient(to bottom, transparent, #fff); 
            cursor: ns-resize; transition: 0.3s; position: relative;
        }
        .string::after {
            content: ''; position: absolute; bottom: -10px; left: -4px;
            width: 10px; height: 10px; background: #fff; border-radius: 50%;
            box-shadow: 0 0 10px #fff;
        }
        .string.pulled { height: 120px; opacity: 0; pointer-events: none; }
        .hint-text { font-size: 8px; tracking: 2px; text-transform: uppercase; color: rgba(255,255,255,0.4); margin-right: 10px; }

        .reveal-p { opacity: 0; transform: translateX(-30px); transition: all 1.5s ease; filter: blur(10px); display: none; }
        .reveal-p.active { opacity: 1; transform: translateX(0); filter: blur(0); display: block; }

        /* --- PHOTO SECTION --- */
        .photo-frame { 
            position: relative; overflow: hidden; background: #000; 
            transition: 1.5s; filter: brightness(0);
        }
        .photo-frame.lit { filter: brightness(1) sepia(0.2); box-shadow: 0 0 50px rgba(255, 183, 77, 0.2); }
        .firefly {
            position: absolute; width: 4px; height: 4px; background: #ffeb3b;
            border-radius: 50%; filter: blur(1px); box-shadow: 0 0 10px #ffeb3b;
            pointer-events: none; opacity: 0;
        }
        @keyframes fireflyFly {
            0% { transform: translate(0, 0); opacity: 0; }
            50% { opacity: 0.8; }
            100% { transform: translate(var(--x), var(--y)); opacity: 0; }
        }

        .f-serif { font-family: 'Cormorant Garamond', serif; }
        .f-tenor { font-family: 'Tenor Sans', sans-serif; }
    </style>
</head>
<body oncontextmenu="return false">

    <div id="login-screen">
        <div class="flex flex-col items-center">
            <h1 class="f-tenor text-white text-5xl tracking-[18px] mb-2 opacity-100 drop-shadow-2xl">WELCOME</h1>
            <p class="text-[8px] text-white/40 tracking-[6px] uppercase mb-12">Access Private Journal</p>
            <div class="login-box">
                <input type="text" id="username" placeholder="IDENTITAS" autocomplete="off">
                <input type="password" id="password" placeholder="KATA SANDI" autocomplete="off">
                <div class="login-btn" onclick="validateLogin()">
                    <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
                </div>
            </div>
        </div>
    </div>

    <div id="main-content">
        <div class="mesh-gradient-bg"></div>
        <div id="rain-layer"></div>

        <div class="fixed top-8 left-8 z-[100] bg-black/40 backdrop-blur-md px-4 py-1 rounded-full border border-white/5">
            <span class="text-[8px] font-light tracking-[3px] text-gray-400 uppercase" id="clock">00:00:00</span>
        </div>

        <main class="max-w-[500px] mx-auto px-8 py-32 text-center relative z-10">
            
            <div class="weather-container">
                <div class="flex justify-between items-end mb-4">
                    <div>
                        <p id="weather-city" class="text-[10px] tracking-widest uppercase opacity-60">Memuat Lokasi...</p>
                        <h2 id="weather-temp" class="text-4xl font-light">--Â°</h2>
                        <p id="weather-desc" class="text-[10px] uppercase tracking-widest">--</p>
                    </div>
                    <div class="text-right">
                        <p id="current-date" class="text-[10px] opacity-60">--</p>
                    </div>
                </div>
                <div class="weather-scroll" id="hourly-forecast">
                    </div>
            </div>

            <header class="mb-32">
                <p class="text-[9px] tracking-[6px] text-[#c4a47c] uppercase opacity-70">Journal Entry â€” 2026</p>
                <h1 class="f-serif text-5xl text-white italic mt-3">For Elfrida</h1>
            </header>

            <div class="pull-container" id="photo-pull-section">
                <span class="hint-text">Tarik untuk nyalakan lampu foto</span>
                <div class="string" onmousedown="pullString(this, 'photo')"></div>
                <div id="photo-area" class="photo-frame border border-white/5 p-2 bg-white/5 backdrop-blur-sm mt-8 w-full opacity-0 transition-opacity duration-1000">
                    <img src="PXL_20250805_071541629.PORTRAITbb.jpg" class="w-full grayscale hover:grayscale-0 transition-all duration-1000">
                    <div id="firefly-box" class="absolute inset-0 pointer-events-none"></div>
                </div>
            </div>

            <div class="text-left space-y-12 mt-20" id="letter-body">
                <div class="pull-container p-trigger">
                    <span class="hint-text">Geser untuk membaca</span>
                    <div class="string" onmousedown="pullString(this, 'p1')"></div>
                    <p id="p1" class="f-serif text-2xl italic text-white/90 leading-relaxed reveal-p">
                        Terima kasih banyak ya, sudah bersedia menerima hadiah kecil dariku. Aku tahu kehadirannya mungkin terasa mengagetkan, sampai-sampai kamu belum berani membukanya...
                    </p>
                </div>

                <div class="pull-container p-trigger" style="display:none">
                    <span class="hint-text">Lanjut baca</span>
                    <div class="string" onmousedown="pullString(this, 'p2')"></div>
                    <p id="p2" class="font-light text-[14px] text-gray-400 leading-relaxed reveal-p">
                        Namun ketahuilah, hijab itu kupilihkan dengan seluruh doa agar ia bisa menjagamu, sebagaimana aku ingin selalu menjagamu. Cobalah pakai mahkota indah itu, dandanlah yang cantik untukku.
                    </p>
                </div>

                <div class="pull-container p-trigger" style="display:none">
                    <span class="hint-text">Lanjut baca</span>
                    <div class="string" onmousedown="pullString(this, 'p3')"></div>
                    <p id="p3" class="f-serif text-3xl text-white py-12 border-y border-white/10 text-center italic leading-snug reveal-p">
                        "Sebab bagiku, kamu bukan sekadar pilihan, melainkan sebuah ketetapan yang ingin aku syukuri seumur hidupku."
                    </p>
                </div>

                <div class="pull-container p-trigger" style="display:none">
                    <span class="hint-text">Lanjut baca</span>
                    <div class="string" onmousedown="pullString(this, 'p4')"></div>
                    <p id="p4" class="font-light text-[14px] text-gray-400 leading-relaxed reveal-p">
                        Aku ingin melihat bagaimana dunia menjadi lebih indah dalam satu bingkai foto darimu. Nanti, kirimkan fotonya padaku ya jika jilbabnya sudah kamu pakai. Biarkan aku menyimpan satu kenangan betapa sempurnanya kamu di sana.
                    </p>
                </div>

                <div class="pull-container p-trigger" style="display:none">
                    <span class="hint-text">Hampir selesai</span>
                    <div class="string" onmousedown="pullString(this, 'p5')"></div>
                    <p id="p5" class="font-light text-[14px] text-gray-400 leading-relaxed reveal-p">
                        Aku paham bahwa perjalanan kita mungkin tidak akan selalu lurus dan mudah. Namun bagiku, setiap lika-liku bersamamu adalah bagian dari cerita yang tak ingin aku lewatkan. Aku ingin menjadi rumah tempatmu pulang.
                    </p>
                </div>
            </div>

            <footer class="mt-40 opacity-0 transition-opacity duration-1000" id="final-footer">
                <p class="f-tenor text-2xl tracking-[10px] text-white/80 uppercase">Himam Aby Maulana</p>
                <p class="text-[7px] tracking-[4px] mt-4 opacity-30 uppercase">Â© Forever Virya Archive</p>
            </footer>
        </main>
    </div>

    <audio id="player" src="Ed Sheeran - Perfect.mp3" loop></audio>

    <script>
        // --- WEATHER LOGIC ---
        async function fetchWeather() {
            try {
                const pos = await new Promise((res, rej) => navigator.geolocation.getCurrentPosition(res, rej));
                const lat = pos.coords.latitude;
                const lon = pos.coords.longitude;
                
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,weathercode&current_weather=true&timezone=auto`);
                const data = await res.json();

                document.getElementById('weather-temp').innerText = Math.round(data.current_weather.temperature) + 'Â°';
                document.getElementById('weather-desc').innerText = getWeatherDesc(data.current_weather.weathercode);
                document.getElementById('weather-city').innerText = "Sekitar Lokasi Anda";
                
                const forecastEl = document.getElementById('hourly-forecast');
                forecastEl.innerHTML = '';
                for(let i=0; i<24; i++) {
                    const time = new Date(data.hourly.time[i]).getHours();
                    forecastEl.innerHTML += `
                        <div class="hour-item">
                            <p class="text-[8px] opacity-50">${time}:00</p>
                            <p class="text-[12px] my-1">${Math.round(data.hourly.temperature_2m[i])}Â°</p>
                            <p class="text-[10px]">${getWeatherEmoji(data.hourly.weathercode[i])}</p>
                        </div>
                    `;
                }
            } catch (e) {
                document.getElementById('weather-city').innerText = "Akses Lokasi Ditolak";
            }
        }

        function getWeatherDesc(code) {
            if (code <= 3) return "Cerah Berawan";
            if (code <= 48) return "Berkabut";
            if (code <= 67) return "Gerimis/Hujan";
            return "Badai Petir";
        }
        function getWeatherEmoji(code) {
            if (code <= 1) return "â˜€ï¸";
            if (code <= 3) return "â˜ï¸";
            if (code <= 67) return "ðŸŒ§ï¸";
            return "â›ˆï¸";
        }

        // --- INTERACTION LOGIC ---
        function pullString(el, target) {
            el.classList.add('pulled');
            setTimeout(() => {
                el.parentElement.style.display = 'none';
                if(target === 'photo') {
                    const area = document.getElementById('photo-area');
                    area.classList.add('lit');
                    area.style.opacity = "1";
                    createFireflies();
                } else {
                    const p = document.getElementById(target);
                    p.classList.add('active');
                    // Show next trigger
                    const next = el.parentElement.nextElementSibling;
                    if(next && next.classList.contains('p-trigger')) {
                        next.style.display = 'flex';
                    } else {
                        document.getElementById('final-footer').style.opacity = "1";
                    }
                }
            }, 500);
        }

        function createFireflies() {
            const box = document.getElementById('firefly-box');
            for(let i=0; i<15; i++) {
                const f = document.createElement('div');
                f.className = 'firefly';
                f.style.left = Math.random() * 100 + '%';
                f.style.top = Math.random() * 100 + '%';
                f.style.setProperty('--x', (Math.random() * 100 - 50) + 'px');
                f.style.setProperty('--y', (Math.random() * 100 - 50) + 'px');
                f.style.animation = `fireflyFly ${2 + Math.random() * 3}s infinite alternate`;
                box.appendChild(f);
            }
        }

        // --- ORIGINAL HELPERS ---
        function validateLogin() {
            const pass = document.getElementById('password').value;
            if (pass.toUpperCase() === "FLAFOUR") {
                document.body.classList.add('unlocked');
                setTimeout(() => {
                    document.getElementById('login-screen').style.display = 'none';
                    if (audio.paused) audio.play();
                    fetchWeather();
                }, 1500);
            }
        }

        const audio = document.getElementById('player');
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'long' });
        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString('en-GB'); }, 1000);

        setInterval(() => {
            if(!document.body.classList.contains('unlocked')) return;
            const drop = document.createElement('div');
            drop.className = 'rain';
            drop.style.left = Math.random() * 100 + 'vw';
            drop.style.animationDuration = (Math.random() * 0.4 + 0.3) + 's';
            document.getElementById('rain-layer').appendChild(drop);
            setTimeout(() => drop.remove(), 800);
        }, 50);

        function secure() { document.body.classList.add('protected'); }
        function release() { document.body.classList.remove('protected'); }
        window.addEventListener('blur', secure);
        window.addEventListener('focus', release);
    </script>
</body>
</html>
